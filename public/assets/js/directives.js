israel.directive("generalHolidays",["$timeout","$compile","JewishHolidaysService","NationalHolidays","NationService",function(a,b,c,d,e){return{restrict:"E",templateUrl:"/assets/templates/holiday.html",link:function(a,c,d){a.$watch("holidays",function(d,e){b(c.contents())(a)});var e=c[0].getElementsByTagName("section");a.next=function(){$(e).fadeOut("fast",function(){a.$apply(function(){a.nationalHoliday?a.id++:a.id=a.getNextJewishHoliday(a.id)}),$(e).fadeIn("fast")})},a.previous=function(){$(e).fadeOut("fast",function(){a.$apply(function(){a.nationalHoliday?a.id--:a.id=a.getPrevJewishHoliday(a.id)}),$(e).fadeIn("fast")})}},controller:["$scope","$timeout","$rootScope",function(a,b,f){function g(){a.nationalHoliday?a.id=0:a.id=a.getNextJewishHoliday()}function h(){b(function(){var a=JSON.parse(localStorage.getItem("nation")),b=new Date,c=angular.extend({},a.data,{timestamp:firebase.database.ServerValue.TIMESTAMP,formatedtime:b.toDateString()+" "+b.toLocaleTimeString()});firebase.database().ref("countries/"+a.data.country_code).push(c)},1e4)}function i(b,c){var d=b.data,g=_.filter(c,function(a){var b=moment(a.date,"YYYY-MM-DD");return a.daysLeft=Math.round((b-j)/864e5),a.months=parseInt(a.daysLeft/30),a.weeks=parseInt(a.daysLeft/7),a.days=a.daysLeft%7,a.friendlyDate=moment(a.date,"YYYY-MM-DD").format("LLLL"),a.daysLeft>=0&&a.yomtov===!0}),i=_.filter(d,function(a){a.date=a.date.year?a.date.year+"-"+a.date.month+"-"+a.date.day:a.date,a.observed=a.observed||a.date;var b=moment(a.observed,"YYYY-MM-DD");a.daysLeft=Math.round((b-j)/864e5),a.months=parseInt(a.daysLeft/30),a.weeks=parseInt(a.daysLeft/7),a.days=a.daysLeft%7,a.national=!0,a.title=a.name||a.localName,a.friendlyDate=moment(a.date,"YYYY-MM-DD").format("LLLL");var c=JSON.parse(localStorage.getItem("nation"));return a.style={background:'url("'+e.getFlagByCode(c.data.country_code)+'") 50% 50%',"-webkit-background-clip":"text","-webkit-text-fill-color":"transparent"},a.daysLeft>=0});console.log(i);var k=_.sortBy(_.union(i,g),"daysLeft");a.holidays=k,f.$broadcast("got_holidays",!1),h()}a.id=0,a.holidays={},a.nationalHoliday=!0,f.$on("nationalHoliday",function(b,c){a.nationalHoliday=c,g()}),a.getNextJewishHoliday=function(b){b=b+1||0;for(var c=b;c<a.holidays.length;c++)if(!a.holidays[c].national)return c;return 0},a.getPrevJewishHoliday=function(b){if(b>0){b--;for(var c=b;c>=0;c--)if(!a.holidays[c].national)return c}return 0};var j=c.getDate();c.getHolidays().then(function(a){var b=a.data.items;localStorage.setItem("jewish_holidays",JSON.stringify(a)),f.$broadcast("got_holidays",!0),d.getHolidays(e).then(function(a){i(a,b)},function(a){var c={data:{holidays:[]}};i(c,b)})})}]}}]).directive("nationalHolidaysD",["$rootScope","NationService","$timeout",function(a,b,c){return{scope:{},templateUrl:"/assets/templates/national-holidays.html",link:function(a,b,c){},controller:["$scope",function(c){c.nationalHoliday=!0,c.switch=function(){c.nationalHoliday=!c.nationalHoliday,a.$broadcast("nationalHoliday",c.nationalHoliday)},c.nation={},b.getNation().then(function(a){c.nation=a.data,c.nation.icon=b.getFlagByCode(c.nation.country_code)})}]}}]).directive("loaderHolidays",["$rootScope",function(a){return{scope:{},templateUrl:"/assets/templates/loader-holidays.html",link:function(b,c,d){b.jewish=!1,a.$on("got_holidays",function(a,d){b.jewish=d,d||(c[0].style.display="none")})}}}]);